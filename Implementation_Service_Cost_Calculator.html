<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Odoo Success Pack Calculator (Modern Bold Redesign)</title>
    <!-- Load Inter font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        'bold-header': '#2c3e50', // Dark but softer blue/gray for header
                        'bold-bg': '#F4F7FA', // Very light gray background
                        'bold-card': '#FFFFFF', // White cards
                        'bold-primary': '#007AFF', // Modern iOS/web Blue for main branding/buttons
                        'bold-secondary': '#5B5BEB', // Accent Purple (kept for dropdown arrow/links)
                        'bold-success': '#28A745', // Standard Success Green for savings
                        'bold-dark-text': '#34495E', // Dark text
                        'bold-info': '#007AFF', // Vibrant Blue for Core Pricing Breakdown & Final Price
                    },
                    boxShadow: {
                        'soft': '0 4px 10px rgba(0, 0, 0, 0.05)',
                        'btn-subtle': '0 2px 5px rgba(0, 122, 255, 0.3)',
                    }
                }
            }
        }
    </script>
    <style>
        /* Base styling for the whole container */
        .calculator-container {
            max-width: 900px;
            margin: 0 auto;
        }

        /* Custom styling for the select dropdown */
        .select-input {
            /* Standard dropdown styling, keeping purple arrow for contrast/legacy */
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%235B5BEB'%3E%3Cpath d='M7 10l5 5 5-5z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 1rem center;
            padding-right: 2.5rem !important; /* Make space for the icon */
            appearance: none; /* Hide default arrow */
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.2s ease;
        }
        
        /* Focus state for select and input */
        .select-input:focus, input[type="number"]:focus {
            box-shadow: 0 0 0 2px #FFFFFF, 0 0 0 4px theme('colors.bold-primary');
            border-color: theme('colors.bold-primary');
        }
        
        /* Currency Segmented Control */
        .segmented-control {
            border: 1px solid #D1D5DB;
            padding: 4px;
            background-color: #E5E7EB;
            border-radius: 8px;
        }

        .segmented-control button {
            transition: all 0.2s ease-in-out;
            padding: 8px 20px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 0.9rem;
            color: #4B5563;
        }

        .segmented-control button.active {
            background-color: white;
            color: theme('colors.bold-primary');
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        /* Custom styling for the large Final Price display */
        #finalPriceDisplay {
            color: theme('colors.bold-info'); 
            font-size: 2.5rem; 
            line-height: 1;
            font-weight: 900;
            text-shadow: none; /* Removing text shadow for cleaner look */
            transition: all 0.5s ease;
        }
        @media (min-width: 768px) {
            #finalPriceDisplay {
                font-size: 4rem; 
            }
        }

        /* Core Pricing Breakdown value style */
        .core-price-value {
            color: theme('colors.bold-info');
            font-weight: 700;
        }

        /* Confetti Styles */
        @keyframes confetti-fall {
            0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }

        .confetti {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
            z-index: 1000;
        }
        .confetti-piece {
            position: absolute;
            width: 10px;
            height: 20px;
            background-color: var(--color);
            animation: confetti-fall 3s ease-in-out forwards;
        }
    </style>
</head>
<body class="bg-bold-bg min-h-screen font-sans antialiased">

    <!-- Global Navigation (Simple Top Bar) -->
    <nav class="flex justify-center gap-4 py-4 text-sm font-medium border-b border-gray-200 bg-white">
        <a href="#" class="px-3 py-1 text-gray-600 hover:text-bold-primary transition-colors">Yearly vs Monthly Price</a>
        <a href="#" class="px-3 py-1 text-gray-600 hover:text-bold-primary transition-colors">Multi-Year Contracts</a>
        <a href="#" class="px-3 py-1 text-bold-primary font-bold border-b-2 border-bold-primary">Implementation Service</a>
    </nav>


    <div class="calculator-container p-4 md:p-10">

        <!-- Header Section (Modernized) -->
        <header class="text-center mb-10 bg-bold-header text-white rounded-xl shadow-xl p-8 md:p-12">
            <h1 class="text-3xl md:text-5xl font-extrabold mb-2">Odoo Success Pack Calculator</h1>
            <p class="text-md md:text-lg text-gray-300">Compare Implementation Cost and Analyze NRR Target.</p>
        </header>

        <!-- Main Calculator Card -->
        <div class="bg-bold-card p-6 sm:p-8 rounded-xl shadow-2xl border border-gray-200">
            
            <!-- Section 1: Inputs and Currency -->
            <h2 class="text-xl font-bold text-bold-dark-text mb-4 border-b pb-2">1. Pick the Implementation Hours & Set Discount</h2>
            
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8 items-start">
                
                <!-- Implementation Hours Selector (Dropdown) -->
                <div class="lg:col-span-2 space-y-4">
                    <label for="hours" class="block text-sm font-medium text-gray-600">Success Pack (Hours)</label>
                    <select id="hours" class="select-input w-full p-3 border border-gray-300 bg-white text-bold-dark-text text-lg font-bold">
                        <!-- Options generated dynamically or listed here -->
                        <option value="25">25 Hours</option>
                        <option value="50">50 Hours</option>
                        <option value="75">75 Hours</option>
                        <option value="100" selected>100 Hours</option>
                        <option value="125">125 Hours</option>
                        <option value="150">150 Hours</option>
                        <option value="175">175 Hours</option>
                        <option value="200">200 Hours</option>
                        <option value="225">225 Hours</option>
                        <option value="250">250 Hours</option>
                        <option value="275">275 Hours</option>
                        <option value="300">300 Hours</option>
                    </select>
                </div>

                <!-- Discount Input -->
                <div class="space-y-4">
                    <label for="discount" class="block text-sm font-medium text-gray-600">Discount (%)</label>
                    <div class="relative">
                        <input type="number" id="discount" value="15" min="0" max="100" class="w-full p-3 border border-gray-300 text-bold-dark-text text-center text-lg font-bold rounded-lg focus:ring-2 focus:ring-bold-primary focus:border-bold-primary pr-10">
                        <span class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 font-semibold">%</span>
                    </div>
                    
                    <!-- Currency Selector (Modernized) -->
                    <div class="flex justify-center mt-4">
                        <div class="segmented-control flex" id="currency-selector">
                            <button id="btn-inr" class="active" data-currency="INR">₹ INR</button>
                            <button id="btn-usd" data-currency="USD">$ USD</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section 2: Core Pricing Results -->
            <h2 class="text-xl font-bold text-bold-dark-text mb-4 border-b pb-2 mt-8">2. Core Pricing Breakdown</h2>

            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8 text-center">
                <!-- Standard Rate -->
                <!-- Updated classes for cleaner, symmetric look: removed bg-bold-info/10 and border-bold-info/30 -->
                <div class="p-4 bg-white rounded-lg border border-gray-200 shadow-soft">
                    <span class="block text-xs font-medium uppercase text-gray-600 mb-1">Standard Rate</span>
                    <span class="value text-lg sm:text-2xl font-bold core-price-value" id="standardRate">₹0.00</span>
                </div>
                <!-- After Discount Price -->
                <div class="p-4 bg-white rounded-lg border border-gray-200 shadow-soft">
                    <span class="block text-xs font-medium uppercase text-gray-600 mb-1" id="afterDiscountLabel">After Discount (15%)</span>
                    <span class="value text-lg sm:text-2xl font-bold core-price-value" id="afterDiscountPrice">₹0.00</span>
                </div>
                <!-- Per Hour Rate -->
                <div class="p-4 bg-white rounded-lg border border-gray-200 shadow-soft">
                    <span class="block text-xs font-medium uppercase text-gray-600 mb-1">Per Hour Rate</span>
                    <span class="value text-lg sm:text-2xl font-bold core-price-value" id="perHourAfterDiscount">₹0.00</span>
                </div>
                <!-- GST (18%) -->
                <div class="p-4 bg-white rounded-lg border border-gray-200 shadow-soft">
                    <span class="block text-xs font-medium uppercase text-gray-600 mb-1">GST (18%)</span>
                    <span class="value text-lg sm:text-2xl font-bold core-price-value" id="gstAmount">₹0.00</span>
                </div>
            </div>

            <!-- Final Investment and Total Saving (Central Focus) -->
            <div class="text-center my-10 border-t border-gray-200 pt-8">
                <!-- Label uses bold-dark-text for contrast -->
                <p class="text-sm font-semibold uppercase text-bold-dark-text mb-4">Final Investment (GST Included)</p>
                <!-- Final price now uses the vibrant blue color (bold-info) and the updated size from custom CSS -->
                <span id="finalPriceDisplay" class="value" id="finalPrice">₹0.00</span>

                <!-- Savings Area -->
                <div class="mt-6 inline-block p-3 rounded-lg bg-bold-success/10 border border-bold-success/30 shadow-md">
                    <span class="block text-sm font-semibold uppercase text-bold-success mb-1">Total Saving</span>
                    <span class="value text-2xl font-extrabold text-bold-success" id="totalSaving">₹0.00</span>
                </div>
            </div>


            <!-- Section 3: NRR Target Analysis -->
            <h2 class="text-xl font-bold text-bold-dark-text mb-4 border-b pb-2 mt-8">3. Your NRR Target Analysis</h2>
            
            <div class="grid grid-cols-1 sm:grid-cols-3 gap-6 mb-10">
                
                <!-- Target Amount Input -->
                <div class="p-4 bg-gray-50 rounded-lg border border-gray-200 space-y-2">
                    <label for="targetAmount" class="block text-sm font-medium text-gray-600">Enter Your Current NRR Target (USD)</label>
                    <div class="relative">
                        <input type="number" id="targetAmount" value="0" min="0" class="w-full p-3 border border-gray-300 text-lg font-bold text-bold-dark-text text-center rounded-lg focus:ring-2 focus:ring-bold-primary focus:border-bold-primary pl-8">
                        <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 font-semibold">$</span>
                    </div>
                </div>

                <!-- Required Amount -->
                <div class="p-4 rounded-lg border border-gray-200 text-center bg-white">
                    <span class="block text-xs font-medium uppercase text-gray-500 mb-1">Amount to Reach NRR Target</span>
                    <span class="value text-lg sm:text-2xl font-bold text-red-500" id="requiredAmount">$0.00</span>
                </div>

                <!-- Percentage Achieved -->
                <div class="p-4 rounded-lg border border-gray-200 text-center bg-white">
                    <span class="block text-xs font-medium uppercase text-gray-500 mb-1">Target Achieved</span>
                    <span class="value text-lg sm:text-2xl font-bold text-bold-dark-text" id="percentageAchieved">0.00%</span>
                </div>
            </div>
            
            <!-- Action Button (Modernized) -->
            <div class="flex justify-center mt-6">
                <button onclick="generateReport()" class="w-full sm:w-auto bg-bold-primary hover:bg-blue-600 text-white font-semibold py-3 px-8 rounded-lg shadow-btn-subtle transition-all duration-300">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline mr-2 -mt-0.5" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M5 4v3h5v2H5v3h5v2H5v3h5v2H4a1 1 0 01-1-1V5a1 1 0 011-1h12a1 1 0 011 1v10a1 1 0 01-1 1h-1a1 1 0 100 2h1a3 3 0 003-3V5a3 3 0 00-3-3H4a3 3 0 00-3 3v10a3 3 0 003 3h1a1 1 0 100-2H4V4z" clip-rule="evenodd" />
                    </svg>
                    Print Report
                </button>
            </div>
        </div>
    </div>
    
    <!-- Hidden Print Area -->
    <div id="report-print-area" class="hidden"></div>

    <script>
        // --- Configuration (Pricing Constants) ---
        const RATES_INR = {
            25: 95570, 50: 186153, 75: 281722, 100: 332416, 125: 427986,
            150: 518569, 175: 614139, 200: 694831, 225: 760401, 250: 850994,
            275: 946554, 300: 997247
        };
        const ALL_HOURS = Object.keys(RATES_INR).map(h => parseInt(h));

        const USD_INR_RATE = 80; 
        let currentCurrency = 'INR';
        let confettiShown = false;
        let timeoutId = null; 
        let currentHours = 100;

        // --- DOM Elements (Cached) ---
        const hoursInput = document.getElementById('hours'); // The select dropdown
        const discountInput = document.getElementById('discount');
        const targetAmountInput = document.getElementById('targetAmount');
        const standardRateSpan = document.getElementById('standardRate');
        const afterDiscountLabel = document.getElementById('afterDiscountLabel');
        const afterDiscountPriceSpan = document.getElementById('afterDiscountPrice');
        const totalSavingSpan = document.getElementById('totalSaving');
        const gstAmountSpan = document.getElementById('gstAmount');
        const finalPriceDisplay = document.getElementById('finalPriceDisplay'); // Used for large text
        const perHourAfterDiscountSpan = document.getElementById('perHourAfterDiscount');
        const requiredAmountSpan = document.getElementById('requiredAmount');
        const percentageAchievedSpan = document.getElementById('percentageAchieved');
        const currencySelector = document.getElementById('currency-selector');
        
        const ODOO_REPORT_LOGO_URL = "https://placehold.co/150x40/007AFF/ffffff?text=Odoo+Logo"; // Updated logo placeholder color

        // --- Utility Functions ---

        const debounce = (func, delay) => {
            return function(...args) {
                clearTimeout(timeoutId);
                timeoutId = setTimeout(() => {
                    func.apply(this, args);
                }, delay);
            };
        };


        function showConfetti() {
            if (confettiShown) return;
            confettiShown = true;
            
            const confettiContainer = document.createElement('div');
            confettiContainer.className = 'confetti';
            document.body.appendChild(confettiContainer);

            // Using the modern color scheme for confetti
            const colors = ['#007AFF', '#28A745', '#FFC107', '#5B5BEB'];
            const pieceCount = 50;

            for (let i = 0; i < pieceCount; i++) {
                const piece = document.createElement('div');
                piece.className = 'confetti-piece';
                
                const size = Math.random() * 8 + 4;
                piece.style.width = `${size}px`;
                piece.style.height = `${size * 2}px`;
                piece.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                piece.style.left = `${Math.random() * 100}vw`;
                piece.style.animationDelay = `${Math.random() * 0.5}s`;
                piece.style.animationDuration = `${Math.random() * 2 + 3}s`;
                piece.style.transform = `rotate(${Math.random() * 360}deg)`; 
                
                confettiContainer.appendChild(piece);
            }

            setTimeout(() => {
                confettiContainer.remove();
                confettiShown = false;
            }, 4000);
        }

        /**
         * Animates a numerical change in a DOM element.
         */
        function animateValue(obj, start, end, duration, currency, isPercentage = false) {
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                const currentValue = start + progress * (end - start);
                
                const formatterOptions = { minimumFractionDigits: 2, maximumFractionDigits: 2 };
                
                if (isPercentage) {
                    obj.textContent = `${currentValue.toLocaleString('en-US', formatterOptions)}%`;
                } else {
                    const symbol = currency === 'INR' ? '₹' : '$';
                    obj.textContent = `${symbol}${currentValue.toLocaleString(currency === 'INR' ? 'en-IN' : 'en-US', formatterOptions)}`;
                }
                
                if (progress < 1) {
                    window.requestAnimationFrame(step);
                } else {
                    const finalValue = end.toLocaleString(currency === 'INR' ? 'en-IN' : 'en-US', formatterOptions);
                    if (isPercentage) {
                        obj.textContent = `${finalValue}%`;
                    } else {
                        const symbol = currency === 'INR' ? '₹' : '$';
                        obj.textContent = `${symbol}${finalValue}`;
                    }

                    // Conditional styling for Required Amount
                    if (obj.id === 'requiredAmount') {
                         if (end > 0) {
                            obj.classList.add('text-red-500');
                            obj.classList.remove('text-bold-success');
                        } else {
                            obj.classList.remove('text-red-500');
                            obj.classList.add('text-bold-success');
                        }
                    }
                }
            };
            window.requestAnimationFrame(step);
        }
        
        /**
         * Core calculation and rendering function.
         */
        function calculateAndDraw(duration = 500) {
            // Get hours value directly from the select dropdown
            const hours = parseFloat(hoursInput.value) || 0; 
            currentHours = hours; // Update currentHours variable
            
            const discountPercentage = parseFloat(discountInput.value) || 0;
            const targetAmountUSD = parseFloat(targetAmountInput.value) || 0;

            const standardRateINR = RATES_INR[hours] || 0; 
            const afterDiscountPriceINR = standardRateINR * (1 - discountPercentage / 100);
            const totalSavingINR = standardRateINR - afterDiscountPriceINR;
            const gstAmountINR = afterDiscountPriceINR * 0.18;
            const finalPriceINR = afterDiscountPriceINR + gstAmountINR;
            const perHourAfterDiscountINR = hours > 0 ? afterDiscountPriceINR / hours : 0;
            
            const isUSD = currentCurrency === 'USD';
            const rateMultiplier = isUSD ? (1 / USD_INR_RATE) : 1;

            const displayStandardRate = standardRateINR * rateMultiplier;
            const displayAfterDiscountPrice = afterDiscountPriceINR * rateMultiplier;
            const displayTotalSaving = totalSavingINR * rateMultiplier;
            const displayGstAmount = gstAmountINR * rateMultiplier;
            const displayFinalPrice = finalPriceINR * rateMultiplier;
            const displayPerHourAfterDiscount = perHourAfterDiscountINR * rateMultiplier;

            const afterDiscountPriceUSD = afterDiscountPriceINR / USD_INR_RATE;
            const requiredAmountUSD = targetAmountUSD - afterDiscountPriceUSD;
            
            const displayRequiredAmountUSD = requiredAmountUSD < 0 ? 0 : requiredAmountUSD;
            let percentageAchieved = targetAmountUSD > 0 ? (afterDiscountPriceUSD / targetAmountUSD) * 100 : 0;
            
            // Helper to get current displayed value, handling currency symbols
            const getCurrentValue = (span, isCurrency = true) => {
                const text = span.textContent;
                if (!isCurrency || text.includes('%')) return 0;
                return parseFloat(text.replace(/[^0-9.]/g, '')) || 0;
            };

            // Update Labels
            afterDiscountLabel.textContent = `After Discount (${discountPercentage}%)`;
            
            const animationDuration = duration; 

            // Animate results
            animateValue(standardRateSpan, getCurrentValue(standardRateSpan), displayStandardRate, animationDuration, currentCurrency);
            animateValue(afterDiscountPriceSpan, getCurrentValue(afterDiscountPriceSpan), displayAfterDiscountPrice, animationDuration, currentCurrency);
            animateValue(gstAmountSpan, getCurrentValue(gstAmountSpan), displayGstAmount, animationDuration, currentCurrency);
            animateValue(finalPriceDisplay, getCurrentValue(finalPriceDisplay), displayFinalPrice, animationDuration, currentCurrency);
            animateValue(perHourAfterDiscountSpan, getCurrentValue(perHourAfterDiscountSpan), displayPerHourAfterDiscount, animationDuration, currentCurrency);
            animateValue(totalSavingSpan, getCurrentValue(totalSavingSpan), displayTotalSaving, animationDuration, currentCurrency);
            
            // Animate target results (Required Amount is always USD)
            animateValue(requiredAmountSpan, getCurrentValue(requiredAmountSpan), displayRequiredAmountUSD, animationDuration, 'USD');
            animateValue(percentageAchievedSpan, getCurrentValue(percentageAchievedSpan, false), percentageAchieved, animationDuration, null, true); 

            // Trigger celebration
            if (requiredAmountUSD <= 0 && targetAmountUSD > 0 && !confettiShown) {
                showConfetti();
            }
        }

        function setCurrency(newCurrency) {
            if (currentCurrency === newCurrency) return;
            currentCurrency = newCurrency;
            
            // Update segmented control buttons
            document.querySelectorAll('#currency-selector button').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`#btn-${newCurrency.toLowerCase()}`).classList.add('active');
            
            // Instant calculation on currency switch
            calculateAndDraw(0); 
        }

        function setupEventListeners() {
            // Dropdown change listener (replaces button click logic)
            hoursInput.addEventListener('change', () => calculateAndDraw(500));
            
            // Throttled input for Discount and Target Amount
            const throttledCalculate = debounce(() => calculateAndDraw(500), 300);
            discountInput.addEventListener('input', throttledCalculate);
            targetAmountInput.addEventListener('input', throttledCalculate);
            
            currencySelector.addEventListener('click', (event) => {
                const button = event.target.closest('button');
                if (button && button.dataset.currency) {
                    setCurrency(button.dataset.currency);
                }
            });
        }
        
        function generateReport() {
            calculateAndDraw(0); 
            
            const hours = currentHours;
            const discount = discountInput.value;
            const currency = currentCurrency;

            const standardRate = standardRateSpan.textContent;
            const afterDiscountPrice = afterDiscountPriceSpan.textContent;
            const totalSaving = totalSavingSpan.textContent;
            const gstAmount = gstAmountSpan.textContent;
            const finalPrice = finalPriceDisplay.textContent;
            const perHourAfterDiscount = perHourAfterDiscountSpan.textContent;

            const iframe = document.createElement('iframe');
            iframe.style.display = 'none';
            document.body.appendChild(iframe);

            const iframeDoc = iframe.contentWindow.document;
            iframeDoc.open();
            
            // Print report content
            const reportContent = `
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Odoo Success Pack Report</title>
                    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
                    <style>
                        body { 
                            margin: 0; 
                            padding: 0; 
                            font-family: 'Inter', sans-serif; 
                            font-size: 11pt; 
                            color: #000;
                            box-sizing: border-box;
                            width: 210mm;
                            min-height: 297mm;
                            margin: 0 auto;
                            padding: 25mm;
                        }
                        .report-header {
                            display: flex;
                            align-items: center;
                            justify-content: space-between;
                            padding-bottom: 15px;
                            border-bottom: 1px solid #ddd;
                            margin-bottom: 25px;
                        }
                        /* Updated print header color to modern blue */
                        .report-header h2 { margin: 0; font-size: 20pt; color: #007AFF; font-weight: 700; } 
                        .report-table {
                            width: 100%;
                            border-collapse: collapse;
                            margin-top: 1.5rem;
                        }
                        .report-table th, .report-table td {
                            border-bottom: 1px solid #eee;
                            padding: 12px 0;
                            text-align: left;
                        }
                        .report-table th {
                            font-weight: 600;
                            color: #555;
                            border-top: 1px solid #eee;
                        }
                        .report-section { margin-bottom: 15px; }
                        .report-section strong { font-weight: 700; }
                        .report-footer { margin-top: 2rem; text-align: center; font-size: 9pt; color: #666; }
                        /* Updated print color for Final Price to the new bold-info blue */
                        .final-price-row td {
                            font-size: 14pt;
                            font-weight: 700;
                            color: #007AFF; /* Using the primary blue */
                        }
                        .logo { height: 40px; }
                    </style>
                </head>
                <body>
                    <div class="report-header">
                        <img class="logo" src="${ODOO_REPORT_LOGO_URL}" alt="Odoo Logo" onerror="this.src='https://placehold.co/150x40/007AFF/ffffff?text=Odoo+Logo';" />
                        <h2>Odoo Success Pack Report</h2>
                    </div>
                    <div class="report-section">
                        <strong>Report Date:</strong> ${new Date().toLocaleDateString()}
                    </div>
                    <div class="report-section">
                        <strong>Selected Parameters:</strong>
                        <ul style="list-style-type: disc; padding-left: 20px; margin-top: 10px;">
                            <li>Success Pack: ${hours} Hours</li>
                            <li>Discount: ${discount}%</li>
                            <li>Primary Currency: ${currency}</li>
                        </ul>
                    </div>
                    
                    <table class="report-table">
                        <thead>
                            <tr>
                                <th style="width: 70%;">Pricing Metric</th>
                                <th style="text-align: right;">Value</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Standard Rate</td>
                                <td style="text-align: right;">${standardRate}</td>
                            </tr>
                            <tr>
                                <td>After Discount Price (${discount}%)</td>
                                <td style="text-align: right;">${afterDiscountPrice}</td>
                            </tr>
                            <tr>
                                <td>Total Saving</td>
                                <td style="text-align: right; color: #28A745;">${totalSaving}</td>
                            </tr>
                            <tr>
                                <td>GST (18%)</td>
                                <td style="text-align: right;">${gstAmount}</td>
                            </tr>
                            <tr class="final-price-row">
                                <td>Final Price (18% GST Incl.)</td>
                                <td style="text-align: right; color: #007AFF;">${finalPrice}</td>
                            </tr>
                            <tr>
                                <td>Per Hour Rate (After Discount)</td>
                                <td style="text-align: right;">${perHourAfterDiscount}</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <div class="report-footer">
                        Generated by Odoo Success Pack Calculator. This is a cost estimation and subject to final review.
                    </div>
                </body>
                </html>
            `;

            iframeDoc.write(reportContent);
            iframeDoc.close();
            
            iframe.contentWindow.print();
            
            setTimeout(() => {
                document.body.removeChild(iframe);
            }, 500);
        }

        // --- Initialization ---
        window.onload = function() {
            setupEventListeners();
            calculateAndDraw(0); 
        }
    </script>
</body>
</html>
